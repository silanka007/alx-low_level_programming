more malloc and freeing of memory
